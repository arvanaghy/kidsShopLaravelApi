name: ü•Ç Deploy Laravel Project

on:
  push:
    branches: ["main"]

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - name: üç∑ Checkout code
        uses: actions/checkout@v4

      # - name: Set up PHP
      #   uses: shivammathur/setup-php@15c43e89cdef867065b0213be354c2841860869e
      #   with:
      #     php-version: "8.2"

      # - name: Copy .env
      #   run: php -r "file_exists('.env') || copy('.env.example', '.env');"

      # - name: Install Dependencies
      #   run: composer install -q --no-ansi --no-interaction --no-scripts --no-progress --prefer-dist
      # - name: Generate key
      #   run: php artisan key:generate
      # - name: Directory Permissions
      #   run: chmod -R 777 storage bootstrap/cache

      # - name: Set SSH key permissions
      #   run: chmod 600 /home/runner/.ssh/deploy_key 

      - name: üçª Deploy to FTP Server
        uses: SamKirkland/FTP-Deploy-Action@4.3.1
        with:
          server: "ftp.electroshop24.ir"
          username: "kidsshopapiuser@electroshop24.ir"
          password: "sanazElyas123456789"
          local-dir: "./"
          server-dir: "./"
          exclude: |
            **/.git*
            **/.git*/**
            **/node_modules/**
            **/vendor/**
            **/storage/**
            **/bootstrap/cache/**
            **/public/hot/**
            **/public
            **/public/*
            **/public/images/**
            **/public/storage/**
            **/public/css/**
            **/public/js/**
            .env
            .env.example
            .docker-compose.yml
            .Dockerfile
            nginx.conf
            .dockerignore